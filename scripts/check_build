#!/usr/bin/env ruby
# frozen_string_literal: true

require 'fileutils'

def run(cmd)
  system cmd
end

def capture(cmd)
  `#{cmd}`
end

def clean
  puts 'Clean...'
  run './gradlew clean > /dev/null 2>&1'
end

def build
  puts 'Build...'
  output = capture './gradlew build 2>&1'
  puts output.scan(/> Task .* FAILED|\* What went wrong:\n(?:.+\n)+|BUILD SUCCESSFUL/).join
end

clean
build
